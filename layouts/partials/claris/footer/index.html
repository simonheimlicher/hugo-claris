{{- $page := .Page }}
{{- $title := site.Title }}
{{- $siteAuthor := site.Author.name }}
{{- $recentMaxYears := default 5 ($page.Param "recentMaxYears") }}
{{- $footerPages := where site.RegularPages.ByWeight "Type" "in" site.Params.footer.section }}
{{- /* $defaultFooterLogo := printf "%s%s" $iconsDir "apple-touch-icon.png" */ -}}
{{- /* Generate favicons with https://realfavicongenerator.net/favicon_result?file_id=p1f4mdr89t5lsk11g8au6b165q6#.YI6Qim6xUmo */}}
<footer class="footer">
  <div class="footer_inner inner_horizontal inner_bottom-0">
    {{- if not (or .IsHome (and (isset .Params "footer") (eq .Params.footer false) ) )}}
      {{- with $footerPages }}
        {{- with $title }}
          <h2 class="footer_title">{{- . | markdownify }}</h2>
        {{- end }}
        <div class="grid-footer">
          {{- range $id, $page := $footerPages }}
            <div class="footer_page grid-id-{{ add $id 1 }}">
              {{ $page.Page.Content }}
            </div>
          {{- end }}
        </div>
      {{- end }}
    {{- else }}
      {{- if (or ($page.Param "IntroDescription") ($page.Param "footerFreshArticles)") ) }}
        <div class="grid-footer">
        {{- if ($page.Param "IntroDescription") }}
          <h2>{{ $siteAuthor }}</h2>
          <div class="footer_description">
            <div class="footer_intro">
              {{ ($page.Param "IntroDescription") | markdownify }}
            </div>
            {{- if ( ($page.Param "introURL") ) }}
              {{- $r := T "read_more_about" }}
              <p>
              <a href='{{ absLangURL (default "about/" ($page.Param "introURL") ) }}' title='{{ $r }} {{ $siteAuthor }}'>{{ $r }} {{ $siteAuthor }}</a>
              </p>
            {{- end }}
          </div>
        {{- end }}
        {{- if ($page.Param "footerFreshArticles") }}
          {{- $recentArticles := partialCached "claris/_functions/fresh-content" . }}
          {{- with $recentArticles }}
            <div class="footer_articles">
              <h3>{{- T "recent_articles" (len $recentArticles) }}</h3>
              <ul>
                {{- range ($recentArticles | first 5) }}
                  <li><a href="{{ .Permalink }}" title="{{ .Title }}">{{ .Title }}</a></li>
                {{- end }}
              </ul>
            </div>
          {{- end }}
        {{- end }}
        </div>
      {{- end }}
    {{- end }}
    <div class="footer_copyright">
      <p>{{ T "copyright" }}&nbsp;{{ with ($page.Param "since") }}{{ . }}â€“{{ end }}<span class="year">{{ string (now.Format "2006") }}</span>{{ with $siteAuthor }}&nbsp;{{ . }}{{ end }}. {{ T "all_rights" }}
      </p>
    </div>
  </div>
</footer>
